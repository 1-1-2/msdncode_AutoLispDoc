<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>vlax-tmatrix</title>
<link type="text/css" href="ac.acad_ak.css" rel="StyleSheet">
<link media="print" type="text/css" href="ac.acad_ak_print.css" rel="StyleSheet">
<script src="ac_common.js" language="javascript"></script><script src="ac.strings.js" language="javascript"></script><script src="ac.acad_ak.js" language="javascript"></script>
</head>
<body bgcolor="#ffffff">
<div class="HeadingDiv">
<table class="HeadingTable" border="0" cellspacing="0" cellpadding="0" width="103%">
<tr valign="top">
<td class="BookTitleCell" height="29">
<div class="BookTitle">
<a href="ALR.default.246v.htm"><span class="BookTitleLink">æ˜ç»é€šé“ Visual LISP å‡½æ•°</span></a>
</div>	
									&nbsp;
								</td><td align="right">
<table border="0" cellspacing="0" cellpadding="0" class="HeadNavTable">
<tr>
<td class="InfoLine" id="infoline" align="right">æ˜ç»é€šé“ Visual LISP å‡½æ•°&nbsp;</td><td class="NavGif"><a title="å›åˆ°ä¸Šä¸€å±?.." href="ALR.default.246v.htm"><span onmouseout="showinfo(0);" onmouseover="showinfo(1);" class="HeadNavLink"><img border="0" src="ac.pg_up.gif"></span></a></td><td>&nbsp;</td> 
</tr>
</table>
</td>
</tr>
<tr>
<td colspan="2">
<div class="TopHead">vlax-tmatrix</div>
</td>
</tr>
<tr valign="bottom">
<td height="33" colspan="2">
<table cellpadding="0" cellspacing="0" border="0" class="TabTable">
<tr>
<td width="10">&nbsp;</td>
</tr>
</table>
</td>
</tr>
</table>
</div>
<p id="crleadin" class="cr_leadin">è¿”å› VLA æ–¹æ³•å¯ç”¨çš?4x4 è½¬æ¢çŸ©é˜µçš„é€‚å½“è¡¨ç¤º</p> 
<pre class="prog_in_end">(vlax-tmatrix list)</pre>
<p class="Heading-2">å‚æ•°</p>
<p class="define_head">list</p>
<p class="define_text">ç”±è¡¨ç»„æˆçš„è¡¨ï¼Œå…¶ä¸­æ¯ä¸ªå­è¡¨åŒ…å?4 ä¸ªæ•°å€¼ï¼Œåˆ†åˆ«è¡¨ç¤ºè½¬æ¢çŸ©é˜µçš„å„ä¸ªå…ƒç´ ã€?/p> 
<p class="Heading-2">è¿”å›å€?/p>
<p class="body">ç±»å‹ä¸?SafeArray çš„å˜ä½“ï¼Œè¡¨ç¤º 4x4 è½¬æ¢çŸ©é˜µã€?/p> 
<p class="Heading-2">ç¤ºä¾‹</p>
<p class="body">å®šä¹‰è½¬æ¢çŸ©é˜µå¹¶å°†å…¶å€¼æŒ‡å®šä¸ºå˜é‡ tmatrixï¼?/p> 
<pre class="prog_in">_$ (setq tmatrix (vlax-tmatrix '((1 1 1 0) (1 2 3 0) (2 3 4 5) (2 9 8 3))))</pre>
<pre class="prog_in_end">#&lt;variant 8197 ...&gt;</pre>
<p class="body">ä½¿ç”¨ vlax-safearray->list ä»¥è¡¨çš„å½¢å¼æŸ¥çœ?tmatrix çš„å€¼ï¼š</p> 
<pre class="prog_in">_$ (vlax-safearray-&gt;list (vlax-variant-value tmatrix))</pre>
<pre class="prog_in_end">((1.0 1.0 1.0 0.0) (1.0 2.0 3.0 0.0) (2.0 3.0 4.0 5.0) (2.0 9.0 8.0 3.0))</pre>
<p class="body">ä¸‹é¢çš„ä»£ç åˆ›å»ºä¸€æ¡ç›´çº¿ï¼Œå¹¶ä½¿ç”¨è½¬æ¢çŸ©é˜µå°†å…¶æ—‹è½?90 åº¦ï¼š</p> 
<pre class="prog_in">(defun Example_TransformBy () ; / lineObj startPt endPt matList transMat) </pre>
<pre class="prog_in"></pre>
<pre class="prog_in">(vl-load-com)      ; åŠ è½½ ActiveX æ”¯æŒ</pre>
<pre class="prog_in">(setq acadObject   (vlax-get-acad-object))</pre>
<pre class="prog_in">(setq acadDocument (vla-get-ActiveDocument acadObject))</pre>
<pre class="prog_in">(setq mSpace       (vla-get-ModelSpace acadDocument))</pre>
<pre class="prog_in"></pre>
<pre class="prog_in">;; åˆ›å»ºç›´çº¿</pre>
<pre class="prog_in"></pre>
<pre class="prog_in"> (setq startPt (getpoint &quot;æ‹¾å–èµ·ç‚¹ï¼?quot;))</pre>
<pre class="prog_in"> (setq endPt (vlax-3d-point (getpoint startPt &quot;æ‹¾å–ç»ˆç‚¹ï¼?quot;)))</pre>
<pre class="prog_in"> (setq lineObj (vla-addline mSpace (vlax-3d-point startPt) endPt))</pre>
<pre class="prog_in"></pre>
<pre class="prog_in">;;; ç”¨è½¬æ¢çŸ©é˜µåˆå§‹åŒ– transMat å˜é‡</pre>
<pre class="prog_in">;;; è¯¥çŸ©é˜µå°†å¯¹è±¡ç»•ç‚¹ (0,0,0) æ—‹è½¬ 90 åº¦ã€?/pre>
<pre class="prog_in">;;; å…ˆåˆ›å»ºåŒ…å?4 ä¸ªå­è¡¨çš„åˆ—è¡¨ï¼Œå…¶ä¸­æ¯ä¸ªå­è¡?/pre>
<pre class="prog_in">;;; åŒ…å« 4 ä¸ªæ•°å€¼ï¼Œä»£è¡¨è½¬æ¢çŸ©é˜µçš„å…ƒç´?/pre>
<pre class="prog_in"></pre>
<pre class="prog_in"> (setq matList (list '(0 -1 0 0) '(1 0 0 0) '(0 0 1 0) '(0 0 0 1)))</pre>
<pre class="prog_in"></pre>
<pre class="prog_in">;;; ä½¿ç”¨ vlax-tmatrix å°†è¡¨è½¬æ¢ä¸ºå˜ä½“ã€?/pre>
<pre class="prog_in"></pre>
<pre class="prog_in"> (setq transmat (vlax-tmatrix matlist))</pre>
<pre class="prog_in"></pre>
<pre class="prog_in">;;;  ç”¨å®šä¹‰çš„è½¬æ¢çŸ©é˜µè½¬æ¢ç›´çº¿</pre>
<pre class="prog_in"></pre>
<pre class="prog_in"> (vla-transformby lineObj transMat)</pre>
<pre class="prog_in"> (vla-zoomall acadObject)</pre>
<pre class="prog_in"></pre>
<pre class="prog_in"> (princ &quot;ç›´çº¿å·²è¢«è½¬æ¢ã€?quot;)</pre>
<pre class="prog_in"> (princ)</pre>
<pre class="prog_in_end">)</pre>
<table cellpadding="4" cellspacing="0" border="0" width="100%" class="FooterTable">
<tr valign="top">
<td><P class=element><a href=http://www.mjtd.com>æ˜ç»é€šé“</a> ç‰ˆæƒæ‰€æœ?æœªç»è®¸å¯ ä¸å¾—ä¼ æ’­</td><td><script language=javascript src='ac.acad_mc.js'></script></td><td align="right">&nbsp;<a href="javascript:doComments();"><span class="CommentsLink" title="ç‚¹å‡»æ­¤å¤„å‘é€æœ‰å…³å¯¹æœ¬ä¸»é¢˜çš„è¯„è®º">è¯„è®º</span></a>&nbsp;</td>
</tr>
</table>
<p class="footer_padding">&nbsp;</p>
</body> 
</html>
