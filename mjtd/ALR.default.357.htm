<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>vlax-make-variant</title>
<link type="text/css" href="ac.acad_ak.css" rel="StyleSheet">
<link media="print" type="text/css" href="ac.acad_ak_print.css" rel="StyleSheet">
<script src="ac_common.js" language="javascript"></script><script src="ac.strings.js" language="javascript"></script><script src="ac.acad_ak.js" language="javascript"></script>
</head>
<body bgcolor="#ffffff">
<div class="HeadingDiv">
<table class="HeadingTable" border="0" cellspacing="0" cellpadding="0" width="103%">
<tr valign="top">
<td class="BookTitleCell" height="29">
<div class="BookTitle">
<a href="ALR.default.246v.htm"><span class="BookTitleLink">明经通道 Visual LISP 函数</span></a>
</div>	
									&nbsp;
								</td><td align="right">
<table border="0" cellspacing="0" cellpadding="0" class="HeadNavTable">
<tr>
<td class="InfoLine" id="infoline" align="right">明经通道 Visual LISP 函数&nbsp;</td><td class="NavGif"><a title="回到上一层..." href="ALR.default.246v.htm"><span onmouseout="showinfo(0);" onmouseover="showinfo(1);" class="HeadNavLink"><img border="0" src="ac.pg_up.gif"></span></a></td><td>&nbsp;</td> 
</tr>
</table>
</td>
</tr>
<tr>
<td colspan="2">
<div class="TopHead">vlax-make-variant</div>
</td>
</tr>
<tr valign="bottom">
<td height="33" colspan="2">
<table cellpadding="0" cellspacing="0" border="0" class="TabTable">
<tr>
<td width="10">&nbsp;</td>
</tr>
</table>
</td>
</tr>
</table>
</div>
<p id="crleadin" class="cr_leadin">创建变体数据类型</p>
<pre class="prog_in_end">(vlax-make-variant [value] [type])</pre>
<p class="Heading-2">参数</p>
<p class="define_head">value</p>
<p class="define_text">要指定给变体的值。如果省略该参数，变体将创建为 vlax-vbEmpty 类型（未初始化）。</p> 
<p class="define_head">type</p>
<p class="define_text">变体的类型。可由下列常量之一来表示：</p>
<p class="define_text">
<span class="CharSansBold">vlax-vbEmpty </span>(0) 未初始化（缺省值）</p>
<p class="define_text">
<span class="CharSansBold">vlax-vbNull </span>(1) 不包含有效数据</p>
<p class="define_text">
<span class="CharSansBold">vlax-vbInteger </span>(2) 整数型</p>
<p class="define_text">
<span class="CharSansBold">vlax-vbLong </span>(3) 长整数型</p>
<p class="define_text">
<span class="CharSansBold">vlax-vbSingle </span>(4) 单精度浮点数</p>
<p class="define_text">
<span class="CharSansBold">vlax-vbDouble </span>(5) 双精度浮点数</p>
<p class="define_text">
<span class="CharSansBold">vlax-vbString </span>(8) 字符串</p>
<p class="define_text">
<span class="CharSansBold">vlax-vbObject </span>(9) 对象</p>
<p class="define_text">
<span class="CharSansBold">vlax-vbBoolean</span> (11) 布尔值</p>
<p class="define_text">
<span class="CharSansBold">vlax-vbArray</span> (8192) 数组</p>
<p class="define_text">括号中的整数表示常量的值。在参数中最好指定常量，而不要指定常量的值。因为这些值在后续 AutoCAD 中可能会有所变化。<br> 
<br>
如果不指定 type，vlax-make-variant 根据 value 的值来指定缺省的数据类型。下表是指定给每种 LISP 数据类型的缺省变体数据类型：</p> 
<p class="define_text">
<span class="CharSansBold">nil </span><span class="CharCourier">vlax-vbEmpty</span>
</p>
<p class="define_text">
<span class="CharSansBold">:vlax-null </span><span class="CharCourier">vlax-vbNull</span>
</p>
<p class="define_text">
<span class="CharSansBold">integer </span><span class="CharCourier">vlax-vbLong</span>
</p>
<p class="define_text">
<span class="CharSansBold">real </span><span class="CharCourier">vlax-vbDouble</span>
</p>
<p class="define_text">
<span class="CharSansBold">string</span>
<span class="CharSansBold"> </span><span class="CharCourier">vlax-vbString</span>
</p>
<p class="define_text">
<span class="CharSansBold">VLA-object </span><span class="CharCourier">vlax-vbObject</span>
</p>
<p class="define_text">
<span class="CharSansBold">:vlax-true</span>,<span class="CharSansBold"> :vlax-false</span><span class="CharSansBold">  
</span><span class="CharCourier">vlax-vbBoolean</span>
</p>
<p class="define_text">
<span class="CharSansBold">variant</span> 与初始值的类型相同</p> 
<p class="define_text">
<span class="CharSansBold">vlax-make-safearray</span>
<span class="CharSansBold"> </span><span class="CharCourier">vlax-vbArray</span>
</p>
<p class="Heading-2">返回值</p>
<p class="body">创建的变体。</p>
<p class="Heading-2">示例</p>
<p class="body">使用 vlax-make-variant 的缺省值创建变体：</p> 
<pre class="prog_in">_$ (setq varnil (vlax-make-variant))</pre>
<pre class="prog_in_end">#&lt;variant 0 &gt;</pre>
<p class="body">函数缺省创建未初始化 (vlax-vbEmpty) 的变体。可以用下面的显式调用完成同样的功能：</p> 
<pre class="prog_in">_$ (setq varnil (vlax-make-variant nil))</pre>
<pre class="prog_in_end">#&lt;variant 0 &gt;</pre>
<p class="body">创建整型变体并将其值设置为 5：</p> 
<pre class="prog_in">_$ (setq varint (vlax-make-variant 5 vlax-vbInteger))</pre>
<pre class="prog_in_end">#&lt;variant 2 5&gt;</pre>
<p class="body">重复上述命令，但去掉其中的 type 参数。查看结果：</p> 
<pre class="prog_in">_$ (setq varint (vlax-make-variant 5))</pre>
<pre class="prog_in_end">#&lt;variant 3 5&gt;</pre>
<p class="body">缺省情况下，vlax-make-variant 将给定的整数值指定为长整数数据类型，则不是原先希望的整型。这个样例强调了使用数值时，显式声明变体类型的重要性。</p> 
<p class="body">省略字符串的 type 参数将导致如下结果：</p> 
<pre class="prog_in">_$ (setq varstr (vlax-make-variant &quot;ghost&quot;))</pre>
<pre class="prog_in_end">#&lt;variant 8 ghost&gt;</pre>
<p class="body">要创建包含数组的变体，必须指定类型 vlax-vbArray 以及数组中数据的类型。例如，要创建包含双精度数数组的变体，首先将变量的值设为双精度数组：</p> 
<pre class="prog_in">_$ (setq 4dubs (vlax-make-safearray vlax-vbDouble '(0 . 3)))</pre>
<pre class="prog_in_end">#&lt;safearray...&gt;</pre>
<p class="body">然后将双精度数组指定给变体：</p>
<pre class="prog_in">_$ (vlax-make-variant 4dubs)</pre>
<pre class="prog_in_end">#&lt;variant 8197 ...&gt;</pre>
<p class="see_also">参阅</p>
<p class="body"> <a href="ALR.default.356.htm">vlax-make-safearray</a>、 <a href="ALR.default.377.htm">vlax-variant-change-type</a>、 <a href="ALR.default.378.htm">vlax-variant-type</a> 
和 <a href="ALR.default.379.htm">vlax-variant-value</a> 函数。关于使用变体的详细信息，请参见 
《Visual LISP 开发人员手册》中的 <a href="ms-its:ACAD_ALG.chm::/ALG.06.016.htm">使用变体</a>。</p>
<table cellpadding="4" cellspacing="0" border="0" width="100%" class="FooterTable">
<tr valign="top">
<td><P class=element><a href=http://www.mjtd.com>明经通道</a> 版权所有 未经许可 不得传播</td><td><script language=javascript src='ac.acad_mc.js'></script></td><td align="right">&nbsp;<a href="javascript:doComments();"><span class="CommentsLink" title="点击此处发送有关对本主题的评论">评论</span></a>&nbsp;</td>
</tr>
</table>
<p class="footer_padding">&nbsp;</p>
</body> 
</html>
